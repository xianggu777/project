<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI智能助手</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- MathJax配置 - 符合LaTeX Live标准 -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true,
                packages: {
                    '[+]': ['base', 'ams', 'amssymb', 'newcommand', 'color', 'bbox', 'mathtools']
                }
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            },
            loader: {
                load: ['[tex]/noerrors', '[tex]/ams', '[tex]/amssymb']
            },
            startup: {
                typeset: true,
                ready: () => {
                    console.log('MathJax已完全加载并准备渲染数学公式');
                    return MathJax.startup.defaultReady();
                }
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    
    <!-- Markdown渲染库 -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- 侧边栏 -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-robot"></i> AI助手</h2>
                <button class="sidebar-toggle" id="sidebarToggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            
            <div class="sidebar-menu">
                <div class="menu-item active" data-tab="chat">
                    <i class="fas fa-comments"></i>
                    <span>智能对话</span>
                </div>
                <div class="menu-item" data-tab="history">
                    <i class="fas fa-history"></i>
                    <span>历史记录</span>
                </div>
                <div class="menu-item" data-tab="resources">
                    <i class="fas fa-folder-open"></i>
                    <span>资源库</span>
                </div>
                <div class="menu-item" data-tab="news">
                    <i class="fas fa-newspaper"></i>
                    <span>软件工程新闻</span>
                </div>
                <div class="menu-item" data-tab="office-assistant">
                    <i class="fas fa-briefcase"></i>
                    <span>办公助手</span>
                </div>
                <div class="menu-item" data-tab="settings">
                    <i class="fas fa-cog"></i>
                    <span>设置</span>
                </div>
            </div>
            
            <div class="sidebar-footer">
                <div class="status-indicator">
                    <div class="status-dot online"></div>
                    <span id="currentProviderStatus">DeepSeek API 已连接</span>
                </div>
            </div>
        </div>
        
        <!-- 主内容区 -->
        <div class="main-content">
            <!-- 顶部栏 -->
            <div class="topbar">
                <div class="topbar-left">
                    <button class="topbar-btn" id="menuToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="page-title" id="pageTitle">智能对话</h1>
                </div>
                <div class="topbar-right">
                    <button class="topbar-btn" id="themeToggle">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button class="topbar-btn" id="notificationBtn">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">0</span>
                    </button>
                </div>
            </div>
            
            <!-- 内容区 -->
            <div class="content-area">
                <!-- 智能对话标签页 -->
                <div class="tab-content active" id="chat-tab">
                    <div class="chat-container">
                        <div class="chat-messages" id="chatMessages">
                            <div class="message assistant-message">
                                <div class="message-avatar">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <div class="message-content">
                                    <p>您好！我是您的AI智能助手。我可以帮助您解答问题、处理数学公式、进行对话交流等。请问有什么可以帮助您的吗？</p>
                                    <div class="message-actions">
                                        <button class="action-btn"><i class="fas fa-copy"></i></button>
                                        <button class="action-btn"><i class="fas fa-thumbs-up"></i></button>
                                        <button class="action-btn"><i class="fas fa-thumbs-down"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="chat-input-container">
                            <div class="input-actions">
                                <button class="input-action-btn" id="mathModeBtn" title="数学模式">
                                    <i class="fas fa-square-root-alt"></i>
                                </button>
                                <button class="input-action-btn" id="latexHelpBtn" title="LaTeX帮助">
                                    <i class="fas fa-question-circle"></i>
                                </button>
                                <button class="input-action-btn" id="imageUploadBtn" title="上传图片">
                                    <i class="fas fa-image"></i>
                                </button>
                                <button class="input-action-btn" id="imageAnalysisBtn" title="识别图片文字和UI元素" style="display: none;">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                            <div class="chat-input-wrapper">
                                <textarea class="chat-input" id="chatInput" placeholder="输入您的消息...支持LaTeX数学公式和图片上传，如 $x^2 + y^2 = r^2$"></textarea>
                                <div class="image-preview-area" id="imagePreviewArea" style="display: none;">
                                    <div class="image-preview-container" id="imagePreviewContainer">
                                        <!-- 图片预览将在这里动态生成 -->
                                    </div>
                                    <div class="image-drop-zone" id="imageDropZone">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                        <p>拖拽图片到这里或点击上传</p>
                                        <button class="btn-small btn-primary" id="imageSelectBtn">选择图片</button>
                                    </div>
                                </div>
                            </div>
                            <button class="send-btn" id="sendBtn">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
                  <!-- 历史记录标签页 -->
                <div class="tab-content" id="history-tab">
                    <div class="history-container">
                        <div class="history-header">
                            <h2>对话历史记录</h2>
                            <div class="history-actions">
                                <button class="btn-primary" id="batchClassifyBtn">
                                    <i class="fas fa-tags"></i> 智能分类
                                </button>
                                <button class="btn-secondary" id="exportHistoryBtn">
                                    <i class="fas fa-download"></i> 导出记录
                                </button>
                                <button class="btn-secondary" id="clearHistoryBtn">
                                    <i class="fas fa-trash"></i> 清空记录
                                </button>
                            </div>
                        </div>
                        
                        <div class="history-search">
                            <div class="search-container">
                                <input type="text" id="historySearchInput" placeholder="搜索历史记录...">
                                <button class="btn-primary" id="historySearchBtn">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                            <div class="filter-container">
                                <select id="categoryFilter">
                                    <option value="">所有分类</option>
                                    <option value="technical">技术编程</option>
                                    <option value="academic">学术研究</option>
                                    <option value="math">数学问题</option>
                                    <option value="education">学习教育</option>
                                    <option value="business">商业应用</option>
                                    <option value="general">一般对话</option>
                                </select>
                                <select id="dateFilter">
                                    <option value="">所有时间</option>
                                    <option value="today">今天</option>
                                    <option value="week">本周</option>
                                    <option value="month">本月</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="history-list" id="historyList">
                            <!-- 历史记录项将通过JavaScript动态生成 -->
                        </div>
                    </div>
                </div>
                
                <!-- 资源库标签页 -->
                <div class="tab-content" id="resources-tab">
                    <div class="resources-container">
                        <div class="resources-header">
                            <h2>文档资源库</h2>
                            <div class="resources-actions">
                                <button class="btn-primary" id="uploadBtn">
                                    <i class="fas fa-upload"></i> 上传文档
                                </button>
                                <button class="btn-secondary" id="newFolderBtn">
                                    <i class="fas fa-folder-plus"></i> 新建文件夹
                                </button>
                                <button class="btn-outline-secondary" id="classificationBtn" onclick="showClassificationPanel()">
                                    <i class="fas fa-chart-pie"></i> 分类统计
                                </button>
                            </div>
                        </div>
                        
                        <div class="resources-search">
                            <div class="search-container">
                                <input type="text" id="resourcesSearchInput" placeholder="搜索文档...">
                                <button class="btn-primary" id="resourcesSearchBtn">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                            <div class="filter-container">
                                <select id="typeFilter">
                                    <option value="">所有类型</option>
                                    <option value="pdf">PDF文档</option>
                                    <option value="doc">Word文档</option>
                                    <option value="txt">文本文件</option>
                                    <option value="md">Markdown</option>
                                    <option value="image">图片</option>
                                </select>
                                <select id="categoryFilter">
                                    <option value="">所有分类</option>
                                    <option value="technical">技术文档</option>
                                    <option value="academic">学术研究</option>
                                    <option value="business">商业文档</option>
                                    <option value="education">教育资料</option>
                                    <option value="reference">参考资料</option>
                                    <option value="personal">个人文档</option>
                                    <option value="other">其他文档</option>
                                </select>
                                <select id="sortBy">
                                    <option value="date">按日期排序</option>
                                    <option value="name">按名称排序</option>
                                    <option value="size">按大小排序</option>
                                    <option value="type">按类型排序</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="breadcrumb" id="breadcrumb">
                            <span class="breadcrumb-item active" data-path="/">
                                <i class="fas fa-home"></i> 根目录
                            </span>
                        </div>
                        
                        <div class="resources-content">
                            <div class="resources-grid" id="resourcesGrid">
                                <!-- 资源项将通过JavaScript动态生成 -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 软件工程新闻标签页 -->
                <div class="tab-content" id="news-tab">
                    <div class="news-container">
                        <div class="news-header">
                            <h2>软件工程新闻专栏</h2>
                            <div class="news-actions">
                                <button class="btn-primary" id="refreshNewsBtn">
                                    <i class="fas fa-sync-alt"></i> 刷新新闻
                                </button>
                                <button class="btn-secondary" id="newsSettingsBtn">
                                    <i class="fas fa-cog"></i> 设置
                                </button>
                            </div>
                        </div>
                        
                        <div class="news-search">
                            <div class="search-container">
                                <input type="text" id="newsSearchInput" placeholder="搜索软件工程新闻...">
                                <button class="btn-primary" id="newsSearchBtn">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                            <div class="filter-container">
                                <select id="newsCategoryFilter">
                                    <option value="">所有分类</option>
                                    <option value="development">开发技术</option>
                                    <option value="tools">开发工具</option>
                                    <option value="frameworks">框架更新</option>
                                    <option value="best-practices">最佳实践</option>
                                    <option value="security">安全</option>
                                    <option value="devops">DevOps</option>
                                    <option value="ai">AI与机器学习</option>
                                    <option value="cloud">云计算</option>
                                </select>
                                <select id="newsTimeFilter">
                                    <option value="today">今天</option>
                                    <option value="week">本周</option>
                                    <option value="month">本月</option>
                                    <option value="all">所有时间</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="news-stats">
                            <div class="stats-item">
                                <i class="fas fa-newspaper"></i>
                                <span id="totalNewsCount">0</span>
                                <span>总新闻数</span>
                            </div>
                            <div class="stats-item">
                                <i class="fas fa-clock"></i>
                                <span id="lastUpdateTime">--:--</span>
                                <span>最后更新</span>
                            </div>
                        </div>
                        
                        <div class="news-content">
                            <div class="news-grid" id="newsGrid">
                                <!-- 新闻项将通过JavaScript动态生成 -->
                            </div>
                        </div>
                        
                        <div class="news-loading" id="newsLoading" style="display: none;">
                            <div class="loading-spinner">
                                <i class="fas fa-spinner fa-spin"></i>
                                <span>正在获取新闻...</span>
                            </div>
                        </div>
                        
                        <div class="news-empty" id="newsEmpty" style="display: none;">
                            <i class="fas fa-newspaper"></i>
                            <h3>暂无新闻</h3>
                            <p>点击刷新按钮获取最新的软件工程新闻</p>
                            <button class="btn-primary" onclick="fetchSoftwareEngineeringNews()">
                                <i class="fas fa-sync-alt"></i> 获取新闻
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 办公助手标签页 -->
                <div class="tab-content" id="office-assistant-tab">
                    <div class="office-assistant-container">
                        <div class="oa-header">
                            <h2><i class="fas fa-briefcase"></i> 办公助手</h2>
                            <div class="oa-actions">
                                <button class="btn-primary" id="oaNewAnalysisBtn">
                                    <i class="fas fa-plus"></i> 新建分析
                                </button>
                                <button class="btn-secondary" id="oaHistoryBtn">
                                    <i class="fas fa-history"></i> 分析历史
                                </button>
                            </div>
                        </div>

                        <!-- 文档上传区域 -->
                        <div class="oa-upload-section" id="oaUploadSection">
                            <div class="upload-zone" id="oaUploadZone">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <h3>上传文档</h3>
                                <p>支持PDF、Word、图片等格式，拖拽文件到这里或点击选择</p>
                                <button class="btn-primary" id="oaSelectFileBtn">选择文件</button>
                                <input type="file" id="oaFileInput" accept=".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png,.webp" multiple style="display: none;">
                            </div>

                            <!-- 文档预览区域 -->
                            <div class="oa-document-preview" id="oaDocumentPreview" style="display: none;">
                                <div class="preview-header">
                                    <h3><i class="fas fa-file-alt"></i> 文档信息</h3>
                                    <button class="btn-small btn-secondary" id="oaRemoveDocumentBtn">
                                        <i class="fas fa-times"></i> 移除
                                    </button>
                                </div>
                                <div class="preview-content">
                                    <div class="document-info">
                                        <div class="info-item">
                                            <label>文件名:</label>
                                            <span id="oaFileName">-</span>
                                        </div>
                                        <div class="info-item">
                                            <label>文件大小:</label>
                                            <span id="oaFileSize">-</span>
                                        </div>
                                        <div class="info-item">
                                            <label>文件类型:</label>
                                            <span id="oaFileType">-</span>
                                        </div>
                                    </div>
                                    <div class="preview-actions">
                                        <button class="btn-primary" id="oaStartAnalysisBtn">
                                            <i class="fas fa-brain"></i> 开始分析
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 身份选择区域 -->
                        <div class="oa-identity-section" id="oaIdentitySection" style="display: none;">
                            <div class="section-header">
                                <h3><i class="fas fa-user-tag"></i> 身份识别</h3>
                                <div class="analysis-progress" id="oaAnalysisProgress">
                                    <span class="progress-text">正在分析文档...</span>
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="oaProgressFill" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="identity-content">
                                <div class="ai-suggestions" id="oaAiSuggestions">
                                    <h4>AI推测您的身份可能是：</h4>
                                    <div class="identity-cards" id="oaIdentityCards">
                                        <!-- AI推测的身份卡片将在这里动态生成 -->
                                    </div>
                                </div>

                                <div class="custom-identity">
                                    <h4>或自定义您的身份：</h4>
                                    <div class="identity-input">
                                        <input type="text" id="oaCustomIdentityInput" placeholder="请输入您的身份，如：项目经理、市场专员、技术总监等">
                                        <button class="btn-primary" id="oaConfirmIdentityBtn">确认身份</button>
                                    </div>
                                </div>

                                <div class="selected-identity" id="oaSelectedIdentity" style="display: none;">
                                    <h4>当前选择的身份：</h4>
                                    <div class="identity-display">
                                        <span class="identity-tag" id="oaCurrentIdentity">-</span>
                                        <button class="btn-small btn-secondary" id="oaChangeIdentityBtn">修改</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 分析结果区域 -->
                        <div class="oa-results-section" id="oaResultsSection" style="display: none;">
                            <div class="results-header">
                                <h3><i class="fas fa-chart-line"></i> 分析结果</h3>
                                <div class="results-actions">
                                    <button class="btn-secondary" id="oaExportBtn">
                                        <i class="fas fa-download"></i> 导出结果
                                    </button>
                                    <button class="btn-secondary" id="oaShareBtn">
                                        <i class="fas fa-share"></i> 分享
                                    </button>
                                </div>
                            </div>

                            <div class="results-content">
                                <!-- 文档总结 -->
                                <div class="result-section">
                                    <h4><i class="fas fa-file-alt"></i> 文档总结</h4>
                                    <div class="summary-content" id="oaSummaryContent">
                                        <!-- 文档总结内容 -->
                                    </div>
                                </div>

                                <!-- 思维导图 -->
                                <div class="result-section">
                                    <h4><i class="fas fa-project-diagram"></i> 思维导图</h4>
                                    <div class="mindmap-container" id="oaMindmapContainer">
                                        <div class="mindmap-canvas" id="oaMindmapCanvas">
                                            <!-- 思维导图将在这里渲染 -->
                                        </div>
                                        <div class="mindmap-controls">
                                            <button class="btn-small btn-secondary" id="oaZoomInBtn">
                                                <i class="fas fa-search-plus"></i> 放大
                                            </button>
                                            <button class="btn-small btn-secondary" id="oaZoomOutBtn">
                                                <i class="fas fa-search-minus"></i> 缩小
                                            </button>
                                            <button class="btn-small btn-secondary" id="oaResetViewBtn">
                                                <i class="fas fa-compress"></i> 重置视图
                                            </button>
                                            <button class="btn-small btn-primary" id="oaExpandAllBtn">
                                                <i class="fas fa-expand"></i> 展开全部
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- 关键词导航 -->
                                <div class="result-section">
                                    <h4><i class="fas fa-key"></i> 关键词导航</h4>
                                    <div class="keywords-container" id="oaKeywordsContainer">
                                        <div class="keywords-list" id="oaKeywordsList">
                                            <!-- 关键词列表 -->
                                        </div>
                                        <div class="keyword-detail" id="oaKeywordDetail" style="display: none;">
                                            <!-- 关键词详情 -->
                                        </div>
                                    </div>
                                </div>

                                <!-- 个性化内容 -->
                                <div class="result-section">
                                    <h4><i class="fas fa-filter"></i> 对您重要的内容</h4>
                                    <div class="personalized-content" id="oaPersonalizedContent">
                                        <!-- 基于用户身份的个性化内容 -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 分析历史 -->
                        <div class="oa-history-section" id="oaHistorySection" style="display: none;">
                            <div class="history-header">
                                <h3><i class="fas fa-history"></i> 分析历史</h3>
                                <div class="history-actions">
                                    <button class="btn-secondary" id="oaClearHistoryBtn">
                                        <i class="fas fa-trash"></i> 清空历史
                                    </button>
                                    <button class="btn-primary" id="oaBackToAnalysisBtn">
                                        <i class="fas fa-arrow-left"></i> 返回分析
                                    </button>
                                </div>
                            </div>

                            <div class="history-list" id="oaHistoryList">
                                <!-- 分析历史项将在这里动态生成 -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 设置标签页 -->
                <div class="tab-content" id="settings-tab">
                    <div class="settings-container">
                        <h2>设置</h2>

                        <!-- 设置菜单 -->
                        <div class="settings-menu">
                            <div class="settings-menu-item active" data-settings-tab="general">
                                <i class="fas fa-cog"></i>
                                <span>常规设置</span>
                            </div>
                            <div class="settings-menu-item" data-settings-tab="math-test">
                                <i class="fas fa-calculator"></i>
                                <span>数学公式测试</span>
                            </div>
                            <div class="settings-menu-item" data-settings-tab="latex-guide">
                                <i class="fas fa-book"></i>
                                <span>LaTeX指南</span>
                            </div>
                        </div>

                        <!-- 设置内容 -->
                        <div class="settings-content">
                            <!-- 常规设置 -->
                            <div class="settings-tab-content active" id="general-settings">
                                <div class="setting-section">
                                    <h3>AI提供商配置</h3>
                                    <div class="setting-item">
                                        <label for="aiProvider">AI提供商</label>
                                        <select id="aiProvider">
                                            <option value="deepseek">DeepSeek</option>
                                            <option value="qwen">Qwen (阿里云)</option>
                                        </select>
                                        <button class="btn-secondary" id="testProviderBtn">测试连接</button>
                                    </div>
                                    <div class="setting-item">
                                        <label for="aiModel">模型选择</label>
                                        <select id="aiModel">
                                            <option value="deepseek-chat">deepseek-chat</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="setting-section" id="providerSettings">
                                    <h3>API配置</h3>
                                    <div class="setting-item">
                                        <label for="apiKey">API密钥</label>
                                        <input type="password" id="apiKey" value="sk-3cdc6ca51a254d2aae9673fb3624b3a6" readonly>
                                        <button class="btn-secondary" id="editApiKeyBtn">编辑</button>
                                    </div>
                                    <div class="setting-item" id="appIdSetting" style="display: none;">
                                        <label for="appId">APP ID</label>
                                        <input type="text" id="appId" value="f2bdc02561bf4436ab55f6b94d6a518d" readonly>
                                        <button class="btn-secondary" id="editAppIdBtn">编辑</button>
                                        <small>仅Qwen提供商需要</small>
                                    </div>
                                    <div class="setting-item">
                                        <label for="apiUrl">API地址</label>
                                        <input type="text" id="apiUrl" value="https://api.deepseek.com" readonly>
                                        <button class="btn-secondary" id="editApiUrlBtn">编辑</button>
                                    </div>
                                </div>

                                <div class="setting-section">
                                    <h3>对话设置</h3>
                                    <div class="setting-item">
                                        <label for="responseStyle">回答风格</label>
                                        <select id="responseStyle">
                                            <option value="professional">专业</option>
                                            <option value="casual">轻松</option>
                                            <option value="detailed">详细</option>
                                            <option value="concise">简洁</option>
                                        </select>
                                    </div>
                                    <div class="setting-item">
                                        <label for="maxTokens">最大回答长度</label>
                                        <input type="range" id="maxTokens" min="100" max="4000" value="2000">
                                        <span id="tokenValue">2000</span>
                                    </div>
                                    <div class="setting-item">
                                        <label>
                                            <input type="checkbox" id="mathMode" checked>
                                            启用数学模式
                                        </label>
                                        <span>自动识别和渲染数学公式</span>
                                    </div>
                                </div>

                                <div class="setting-section">
                                    <h3>界面设置</h3>
                                    <div class="setting-item">
                                        <label for="theme">主题</label>
                                        <select id="theme">
                                            <option value="light">浅色</option>
                                            <option value="dark">深色</option>
                                            <option value="auto">跟随系统</option>
                                        </select>
                                    </div>
                                    <div class="setting-item">
                                        <label for="language">语言</label>
                                        <select id="language">
                                            <option value="zh-CN">简体中文</option>
                                            <option value="en-US">English</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="setting-actions">
                                    <button class="btn-primary" id="saveSettingsBtn">保存设置</button>
                                    <button class="btn-secondary" id="resetSettingsBtn">重置默认</button>
                                </div>
                            </div>

                            <!-- 数学公式测试 -->
                            <div class="settings-tab-content" id="math-test-settings">
                                <div class="math-test-container">
                                    <h2>数学公式测试工具</h2>

                                    <div class="test-section">
                                        <h3>常用数学公式</h3>
                                        <div class="formula-grid">
                                            <div class="formula-item" data-latex="x^2 + y^2 = r^2">
                                                <span class="formula-name">圆的方程</span>
                                                <span class="formula-latex">$x^2 + y^2 = r^2$</span>
                                            </div>
                                            <div class="formula-item" data-latex="E = mc^2">
                                                <span class="formula-name">质能方程</span>
                                                <span class="formula-latex">$E = mc^2$</span>
                                            </div>
                                            <div class="formula-item" data-latex="\\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}">
                                                <span class="formula-name">二次公式</span>
                                                <span class="formula-latex">$\\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$</span>
                                            </div>
                                            <div class="formula-item" data-latex="\\int_{-\\infty}^{\\infty} e^{-x^2} dx = \\sqrt{\\pi}">
                                                <span class="formula-name">高斯积分</span>
                                                <span class="formula-latex">$\\int_{-\\infty}^{\\infty} e^{-x^2} dx = \\sqrt{\\pi}$</span>
                                            </div>
                                            <div class="formula-item" data-latex="\\sum_{i=1}^{n} i = \\frac{n(n+1)}{2}">
                                                <span class="formula-name">求和公式</span>
                                                <span class="formula-latex">$\\sum_{i=1}^{n} i = \\frac{n(n+1)}{2}$</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="test-section">
                                        <h3>LaTeX输入测试</h3>
                                        <textarea id="latexInput" placeholder="输入LaTeX公式进行测试，如 \\frac{a}{b} 或 \\sqrt{x^2 + y^2}"></textarea>
                                        <button id="renderLatexBtn" class="btn-primary">渲染公式</button>
                                        <div id="latexResult"></div>
                                    </div>

                                    <div class="test-section">
                                        <h3>中文数学表达式转换</h3>
                                        <textarea id="chineseMathInput" placeholder="输入中文数学表达式，如 x除以y等于z 或 a的b次方"></textarea>
                                        <button id="convertChineseBtn" class="btn-primary">转换为LaTeX</button>
                                        <div id="chineseResult"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- LaTeX指南 -->
                            <div class="settings-tab-content" id="latex-guide-settings">
                                <div class="latex-guide-container">
                                    <h2>LaTeX数学公式指南</h2>
                                    <p>基于 <a href="https://www.latexlive.com/home" target="_blank">LaTeX Live</a> 标准的数学公式编写指南</p>

                                    <div class="guide-section">
                                        <h3>基础语法</h3>
                                        <div class="syntax-table">
                                            <table>
                                                <thead>
                                                    <tr>
                                                        <th>类型</th>
                                                        <th>LaTeX代码</th>
                                                        <th>显示效果</th>
                                                        <th>说明</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td>分数</td>
                                                        <td><code>\\frac{分子}{分母}</code></td>
                                                        <td>$\\frac{a}{b}$</td>
                                                        <td>创建分数</td>
                                                    </tr>
                                                    <tr>
                                                        <td>根号</td>
                                                        <td><code>\\sqrt{表达式}</code></td>
                                                        <td>$\\sqrt{x}$</td>
                                                        <td>平方根</td>
                                                    </tr>
                                                    <tr>
                                                        <td>n次根</td>
                                                        <td><code>\\sqrt[n]{表达式}</code></td>
                                                        <td>$\\sqrt[3]{x}$</td>
                                                        <td>n次方根</td>
                                                    </tr>
                                                    <tr>
                                                        <td>上标</td>
                                                        <td><code>x^{上标}</code></td>
                                                        <td>$x^2$</td>
                                                        <td>指数</td>
                                                    </tr>
                                                    <tr>
                                                        <td>下标</td>
                                                        <td><code>x_{下标}</code></td>
                                                        <td>$x_i$</td>
                                                        <td>下标</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <div class="guide-section">
                                        <h3>高级数学</h3>
                                        <div class="syntax-table">
                                            <table>
                                                <thead>
                                                    <tr>
                                                        <th>类型</th>
                                                        <th>LaTeX代码</th>
                                                        <th>显示效果</th>
                                                        <th>说明</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td>求和</td>
                                                        <td><code>\\sum_{下标}^{上标}</code></td>
                                                        <td>$\\sum_{i=1}^{n}$</td>
                                                        <td>求和符号</td>
                                                    </tr>
                                                    <tr>
                                                        <td>积分</td>
                                                        <td><code>\\int_{下标}^{上标}</code></td>
                                                        <td>$\\int_{0}^{1}$</td>
                                                        <td>积分符号</td>
                                                    </tr>
                                                    <tr>
                                                        <td>极限</td>
                                                        <td><code>\\lim_{变量 \\to 值}</code></td>
                                                        <td>$\\lim_{x \\to 0}$</td>
                                                        <td>极限符号</td>
                                                    </tr>
                                                    <tr>
                                                        <td>矩阵</td>
                                                        <td><code>\\begin{pmatrix} ... \\end{pmatrix}</code></td>
                                                        <td>$\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$</td>
                                                        <td>2x2矩阵</td>
                                                    </tr>
                                                    <tr>
                                                        <td>方程组</td>
                                                        <td><code>\\begin{cases} ... \\end{cases}</code></td>
                                                        <td>$\\begin{cases} x = 1 \\\\ y = 2 \\end{cases}$</td>
                                                        <td>分段函数</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <div class="guide-section">
                                        <h3>希腊字母</h3>
                                        <div class="greek-letters">
                                            <div class="letter-group">
                                                <h4>小写</h4>
                                                <div class="letters">
                                                    <span><code>\\alpha</code> → $\\alpha$</span>
                                                    <span><code>\\beta</code> → $\\beta$</span>
                                                    <span><code>\\gamma</code> → $\\gamma$</span>
                                                    <span><code>\\delta</code> → $\\delta$</span>
                                                    <span><code>\\epsilon</code> → $\\epsilon$</span>
                                                    <span><code>\\theta</code> → $\\theta$</span>
                                                    <span><code>\\lambda</code> → $\\lambda$</span>
                                                    <span><code>\\mu</code> → $\\mu$</span>
                                                    <span><code>\\pi</code> → $\\pi$</span>
                                                    <span><code>\\sigma</code> → $\\sigma$</span>
                                                    <span><code>\\phi</code> → $\\phi$</span>
                                                    <span><code>\\omega</code> → $\\omega$</span>
                                                </div>
                                            </div>
                                            <div class="letter-group">
                                                <h4>大写</h4>
                                                <div class="letters">
                                                    <span><code>\\Alpha</code> → $\\Alpha$</span>
                                                    <span><code>\\Beta</code> → $\\Beta$</span>
                                                    <span><code>\\Gamma</code> → $\\Gamma$</span>
                                                    <span><code>\\Delta</code> → $\\Delta$</span>
                                                    <span><code>\\Theta</code> → $\\Theta$</span>
                                                    <span><code>\\Lambda</code> → $\\Lambda$</span>
                                                    <span><code>\\Pi</code> → $\\Pi$</span>
                                                    <span><code>\\Sigma</code> → $\\Sigma$</span>
                                                    <span><code>\\Phi</code> → $\\Phi$</span>
                                                    <span><code>\\Omega</code> → $\\Omega$</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="guide-section">
                                        <h3>常用技巧</h3>
                                        <ul>
                                            <li><strong>空格处理</strong>：LaTeX会自动处理空格，一般不需要手动添加</li>
                                            <li><strong>大括号</strong>：使用 <code>{}</code> 将多个字符组合在一起，如 <code>x^{12}</code></li>
                                            <li><strong>转义字符</strong>：特殊字符需要转义，如 <code>\\$</code> 显示美元符号</li>
                                            <li><strong>换行</strong>：在矩阵等环境中使用 <code>\\\\</code> 换行</li>
                                            <li><strong>中文支持</strong>：系统支持中文数学表达式自动转换</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 通知容器 -->
    <div class="notification-container" id="notificationContainer"></div>
    
    <!-- 文件上传隐藏输入框 -->
    <input type="file" id="fileInput" style="display: none;" multiple accept=".pdf,.doc,.docx,.txt,.md,.jpg,.jpeg,.png,.gif">

    <!-- 图片上传隐藏输入框 -->
    <input type="file" id="imageInput" style="display: none;" accept=".jpg,.jpeg,.png,.webp,.gif" multiple>
    
    <!-- 文档预览模态框 -->
    <div class="modal" id="documentPreviewModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">文档预览</h3>
                <button class="modal-close" id="modalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- 文档内容将在这里显示 -->
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="modalDownload">
                    <i class="fas fa-download"></i> 下载
                </button>
                <button class="btn-danger" id="modalDelete">
                    <i class="fas fa-trash"></i> 删除
                </button>
                <button class="btn-primary" id="modalCloseBtn">关闭</button>
            </div>
        </div>
    </div>
    
    <!-- 新建文件夹模态框 -->
    <div class="modal" id="newFolderModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>新建文件夹</h3>
                <button class="modal-close" id="newFolderModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <label for="folderNameInput">文件夹名称</label>
                <input type="text" id="folderNameInput" placeholder="请输入文件夹名称">
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="newFolderModalCancel">取消</button>
                <button class="btn-primary" id="newFolderModalConfirm">创建</button>
            </div>
        </div>
    </div>

    <!-- 图片预览模态框 -->
    <div class="modal" id="imagePreviewModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="imageModalTitle">图片预览</h3>
                <button class="modal-close" id="imageModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="imageModalBody">
                <!-- 图片预览内容将在这里动态生成 -->
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="imageModalRemove">移除图片</button>
                <button class="btn-primary" id="imageModalCloseBtn">关闭</button>
            </div>
        </div>
    </div>

    <!-- 历史分类功能脚本 -->
    <script src="history-classification/classifiers/RuleAnalyzer.js"></script>
    <script src="history-classification/classifiers/AIAnalyzer.js"></script>
    <script src="history-classification/classifiers/ResultMerger.js"></script>
    <script src="history-classification/HistoryClassificationManager.js"></script>

    <!-- 文档分类功能脚本 -->
    <script src="classification/category-rules.js"></script>
    <script src="classification/text-extractors.js"></script>
    <script src="classification/document-classifier.js"></script>
    <script src="fix-classification.js"></script>

    <!-- 历史分类系统集成脚本 -->
    <script src="history-classification-integration.js"></script>

    <!-- 办公助手功能脚本 -->
    <script src="office-assistant-fixed.js"></script>

    <!-- 主应用脚本 -->
    <script src="app.js"></script>
</body>
</html>